!function(){"use strict";angular.module("nBlog",["ui.router","config","api","notFound","PageHelpers","BlogHelpers","Site","Posts","Pages","application","index","page","blog"])}(),function(){"use strict";function configure($locationProvider,$urlRouterProvider,$stateProvider,$httpProvider){$locationProvider.hashPrefix("!"),$urlRouterProvider.otherwise("/")}function config(){function getConfig(key){return key?config[key]:config}function setConfig(key,value){config[key]=value}var config={ROOT_URL:""};return{getConfig:getConfig,setConfig:setConfig}}var core=angular.module("config",[]);core.config(configure),core.service("appConfig",config)}(),function(){"use strict";function run($rootScope,$state,Site){console.info("Bootstrapping Angular v.:",angular.version.full),console.log(),$rootScope.$on("$stateChangeStart",function(event,toState,toParams){Object.keys(Site.collection).length<1&&(console.info("No Site Configuration found, fetching..."),event.preventDefault(),Site.init().then(function(){$state.go(toState,toParams)}))})}angular.module("nBlog").run(run)}(),function(){"use strict";angular.module("api",[])}(),function(){"use strict";angular.module("api").constant("API",{root:"content/",blog:{list:"",single:"blog/"},pages:{list:"",single:"pages/"}})}(),function(){"use strict";angular.module("PageHelpers",[])}(),function(){"use strict";function PageHelpers(API,Site){function pathToRoute(path){console.log(path,rootBlogPath);var sanitizedPath=path.replace(rootBlogPath,"");console.log(sanitizedPath)}function pathFromBaseName(routePath){for(var result,i=0,l=Site.collection.pages.length;l>i;i++)Site.collection.pages[i].basename===routePath&&(result=Site.collection.pages[i].path);return result}var rootBlogPath=[API.root,API.pages.single].join("");return{pathToRoute:pathToRoute,pathFromBaseName:pathFromBaseName}}angular.module("PageHelpers").service("PageHelpers",PageHelpers)}(),function(){"use strict";angular.module("BlogHelpers",[])}(),function(){"use strict";function BlogHelpers(API,Site){function pathToRoute(path){console.log(path,rootBlogPath);var sanitizedPath=path.replace(rootBlogPath,"");console.log(sanitizedPath)}function pathFromBaseName(routePath){for(var result,i=0,l=Site.collection.blog.length;l>i;i++)Site.collection.blog[i].basename===routePath&&(result=Site.collection.blog[i].path);return result}var rootBlogPath=[API.root,API.blog.single].join("");return{pathToRoute:pathToRoute,pathFromBaseName:pathFromBaseName}}angular.module("BlogHelpers").service("BlogHelpers",BlogHelpers)}(),function(){"use strict";angular.module("application",[])}(),function(){"use strict";angular.module("application").config(function($stateProvider){var Application={name:"application","abstract":!0,views:{application:{templateUrl:"app/modules/application/application.template.html",controller:"Application",controllerAs:"application"}}};$stateProvider.state(Application)})}(),function(){"use strict";function Application(Site,$scope){function activate(){Site.collection.blog.length>0&&(vm.hasBlog=!0);$scope.$watch(function(){return Site.collection.pages},function(list){angular.isDefined(list)&&(vm.pages=list,vm.viewIsLoading=!1)})}var vm=this;vm.pages=[],vm.viewIsLoading=!0,vm.hasBlog=!1,activate()}angular.module("application").controller("Application",Application)}(),function(){"use strict";angular.module("notFound",[])}(),function(){"use strict";angular.module("notFound").config(function($stateProvider){var notFound={name:"application.notFound",url:"/404",views:{"main@application":{templateUrl:"app/modules/404/404.template.html",controller:"NotFound",controllerAs:"notFound"}}};$stateProvider.state(notFound)})}(),function(){"use strict";function NotFound($scope,Posts){function activate(){}activate()}angular.module("notFound").controller("NotFound",NotFound)}(),function(){"use strict";angular.module("index",[])}(),function(){"use strict";angular.module("index").config(function($stateProvider){var Index={name:"application.index",url:"/",views:{"main@application":{templateUrl:"app/modules/index/index.template.html",controller:"Index",controllerAs:"index"}}};$stateProvider.state(Index)})}(),function(){"use strict";function Index($scope,Site){function activate(){}var vm=this;vm.posts=[],vm.viewIsLoading=!0,activate()}angular.module("index").controller("Index",Index)}(),function(){"use strict";angular.module("page",[])}(),function(){"use strict";angular.module("page").config(function($stateProvider){var Page={name:"application.page",url:"/page/:path",views:{"main@application":{templateUrl:"app/modules/page/page.template.html",controller:"Page",controllerAs:"page"}},resolve:{page:function($stateParams,Pages,PageHelpers){var pagePath=$stateParams.filePath?$stateParams.filePath:PageHelpers.pathFromBaseName($stateParams.path);return Pages.getSingle(pagePath)}}};$stateProvider.state(Page)})}(),function(){"use strict";function Page(page){function activate(){}var vm=this;vm.content=page,console.log(page),activate()}angular.module("page").controller("Page",Page)}(),function(){"use strict";angular.module("blog",[])}(),function(){"use strict";angular.module("blog").config(function($stateProvider){var Blog={name:"application.blog",url:"/blog",views:{"main@application":{templateUrl:"app/modules/blog/blog.template.html",controller:"Blog",controllerAs:"blog"}}},BlogSingle={name:"application.blog.single",url:"/:path",params:{filePath:""},views:{content:{templateUrl:"app/modules/blog/single/blog-single.template.html",controller:"BlogSingle",controllerAs:"blogSingle"}},resolve:{post:function($stateParams,Posts,BlogHelpers){var postPath=$stateParams.filePath?$stateParams.filePath:BlogHelpers.pathFromBaseName($stateParams.path);return Posts.getSingle(postPath)}}};$stateProvider.state(Blog),$stateProvider.state(BlogSingle)})}(),function(){"use strict";function Blog($scope,Site){function activate(){$scope.$watch(function(){return Site.collection.blog},function(list){angular.isDefined(list)&&(vm.posts=list,vm.viewIsLoading=!1)})}console.log("BLOG CONT");var vm=this;vm.posts=[],vm.viewIsLoading=!0,activate()}angular.module("blog").controller("Blog",Blog)}(),function(){"use strict";function BlogSingle(post){function activate(){}var vm=this;vm.post=post,activate()}angular.module("blog").controller("BlogSingle",BlogSingle)}(),function(){"use strict";angular.module("Site",[])}(),function(){"use strict";function Site($q,$http,API){function init(){var deferred=$q.defer(),url=[API.root,"site-config.json"].join("");return $http.get(url).then(function(response){console.log(response.data.pages),response.data.pages&&(service.collection.pages=response.data.pages),response.data.blog&&(service.collection.blog=response.data.blog),console.log(service.collection),deferred.resolve(service.collection)})["catch"](function(err){console.error(err),deferred.reject(err)}),deferred.promise}var service={init:init,collection:{}};return service}angular.module("Site").service("Site",Site)}(),function(){"use strict";angular.module("Posts",[])}(),function(){"use strict";function Post(){var Model=function(data){angular.extend(this,data)};return Model}angular.module("Posts").factory("Post",Post)}(),function(){"use strict";function Posts($q,$http,$sce,$state,API){function getList(){var deferred=$q.defer(),url=[API.root,API.blog.list,"site-config.json"].join("");return $http.get(url).then(function(response){var list=[];response.data.blog&&(list=response.data.blog),service.collection=response.data,deferred.resolve(list)})["catch"](function(err){console.error(err),deferred.reject(err)}),deferred.promise}function getSingle(path){var deferred=$q.defer(),url=path;return $http.get(url).then(function(response){var trustedData=$sce.trustAsHtml(response.data);deferred.resolve(trustedData)})["catch"](function(err){console.error(err),$state.go("application.notFound"),deferred.reject(err)}),deferred.promise}var service={getList:getList,getSingle:getSingle,collection:void 0};return service}angular.module("Posts").service("Posts",Posts)}(),function(){"use strict";angular.module("Pages",[])}(),function(){"use strict";function Page(){var Model=function(data){angular.extend(this,data)};return Model}angular.module("Pages").factory("Page",Page)}(),function(){"use strict";function Pages($q,$http,$sce,$state,API){function getList(){var deferred=$q.defer(),url=[API.root,API.pages.list,"site-config.json"].join("");return $http.get(url).then(function(response){var list=[];response.data.pages&&(list=response.data.pages),service.collection=response.data,deferred.resolve(list)})["catch"](function(err){console.error(err),deferred.reject(err)}),deferred.promise}function getSingle(path){var deferred=$q.defer(),url=path;return $http.get(url).then(function(response){var trustedData=$sce.trustAsHtml(response.data);deferred.resolve(trustedData)})["catch"](function(err){console.error(err),$state.go("application.notFound"),deferred.reject(err)}),deferred.promise}var service={getList:getList,getSingle:getSingle,collection:void 0};return service}angular.module("Pages").service("Pages",Pages)}(),function(){angular.module("nBlog").run(["$templateCache",function($templateCache){"use strict";$templateCache.put("app/modules/404/404.template.html","<h1>404 mofo</h1>"),$templateCache.put("app/modules/application/application.template.html",'<h1>BLOGICATION</h1>\n\n<ul class="menu">\n    <li ng-repeat="page in application.pages">\n        <a ui-sref="application.page({\n            path: page.basename,\n            filePath: page.path\n        })">\n            {{page.title}}\n        </a>\n    </li>\n    <li>\n        <a ui-sref="application.blog">\n            Blog\n        </a>\n    </li>\n</ul>\n\n<div ui-view="main"></div>'),$templateCache.put("app/modules/blog/blog.template.html",'<p>This is the blog view.</p>\n\n<ul>\n    <li ng-repeat="post in blog.posts track by $index">\n        <a ui-sref="application.blog.single({\n            path: post.basename,\n            filePath: post.path\n        })">\n            {{post.title}}\n        </a>\n    </li>\n</ul>\n\n<div ui-view="content"></div>'),$templateCache.put("app/modules/blog/single/blog-single.template.html",'<div ng-bind-html="blogSingle.post"></div>'),$templateCache.put("app/modules/index/index.template.html",'<h1 ng-show="index.viewIsLoading">LOADING</h1>\n<p>This is the index view.</p>'),$templateCache.put("app/modules/page/page.template.html",'<p>This is the page view.</p>\n<div ng-bind-html="page.content"></div>')}])}();